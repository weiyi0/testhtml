var e=(e,a,t)=>new Promise(((l,s)=>{var o=e=>{try{i(t.next(e))}catch(a){s(a)}},n=e=>{try{i(t.throw(e))}catch(a){s(a)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,n);i((t=t.apply(e,a)).next())}));import{y as a,aT as t,aU as l,aV as s,aN as o,aW as n,ai as i,aX as r,aY as c,aZ as d,a_ as u,a$ as m,b0 as g,r as p,L as f,j as h,t as y,u as x,Y as C,B as _,D as v,F,G as S,v as L,a0 as b,a7 as w,H as k,b1 as I,a5 as D}from"./vendor.f1bc6992.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{_ as P,u as E,a as T,L as R,b as j}from"./LoginFormTitle.c7bc8400.js";import{c as G,f as M,e as z,h as B}from"./index.e7d892d4.js";var A=a({name:"LoginForm",components:{[t.name]:t,[l.name]:l,Checkbox:s,Button:o,Form:n,FormItem:n.Item,Input:i,Divider:r,LoginFormTitle:P,InputPassword:i.Password,GithubFilled:c,WechatFilled:d,AlipayCircleFilled:u,GoogleCircleFilled:m,TwitterCircleFilled:g},setup(){const{t:a}=z(),{notification:t,createErrorModal:l}=B(),{prefixCls:s}=G("login"),o=M(),{setLoginState:n,getLoginState:i}=E(),{getFormRules:r}=T(),c=p(),d=p(!1),u=p(!1),m=f({account:"admin",password:"123456",captcha:"",captchaPicPath:"",captchaId:""}),{validForm:g}=j(c),C=h((()=>x(i)===R.LOGIN));function _(){return e(this,null,(function*(){o.getCaptCha().then((e=>{m.captchaPicPath=e.picPath,m.captchaId=e.captchaId}))}))}return _(),{t:a,prefixCls:s,formRef:c,formData:m,getFormRules:r,rememberMe:u,handleLogin:function(){return e(this,null,(function*(){const e=yield g();if(e)try{d.value=!0;const l=yield o.login(y({password:e.password,username:e.account,captcha:e.captcha,captchaId:m.captchaId,mode:"none"}));l&&t.success({message:a("sys.login.loginSuccessTitle"),description:`${a("sys.login.loginSuccessDesc")}: ${l.realName}`,duration:3})}catch(n){l({title:a("sys.api.errorTip"),content:n.message||a("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${s}`)||document.body})}finally{d.value=!1}}))},loading:d,setLoginState:n,LoginStateEnum:R,getShow:C,getCaptcha:_}}});A.render=function(e,a,t,l,s,o){const n=C("LoginFormTitle"),i=C("Input"),r=C("FormItem"),c=C("InputPassword"),d=C("Checkbox"),u=C("ACol"),m=C("Button"),g=C("ARow"),p=C("Divider"),f=C("GithubFilled"),h=C("WechatFilled"),y=C("AlipayCircleFilled"),x=C("GoogleCircleFilled"),P=C("TwitterCircleFilled"),E=C("Form");return _(),v(D,null,[F(L(n,{class:"enter-x"},null,512),[[S,e.getShow]]),F(L(E,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef",onKeypress:I(e.handleLogin,["enter"])},{default:b((()=>[L(r,{name:"account",class:"enter-x"},{default:b((()=>[L(i,{size:"large",value:e.formData.account,"onUpdate:value":a[1]||(a[1]=a=>e.formData.account=a),placeholder:e.t("sys.login.userName")},null,8,["value","placeholder"])])),_:1}),L(r,{name:"password",class:"enter-x"},{default:b((()=>[L(c,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":a[2]||(a[2]=a=>e.formData.password=a),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),L(r,{name:"captcha",class:"enter-x"},{default:b((()=>[L(i,{size:"large",value:e.formData.captcha,"onUpdate:value":a[3]||(a[3]=a=>e.formData.captcha=a),placeholder:e.t("sys.login.captcha")},null,8,["value","placeholder"])])),_:1}),L(r,{name:"captcha",class:"enter-x"},{default:b((()=>[L("img",{src:e.formData.captchaPicPath,onClick:a[4]||(a[4]=(...a)=>e.getCaptcha&&e.getCaptcha(...a)),alt:"t('sys.login.captcha')"},null,8,["src"])])),_:1}),L(g,{class:"enter-x"},{default:b((()=>[L(u,{span:12},{default:b((()=>[L(r,null,{default:b((()=>[L(d,{checked:e.rememberMe,"onUpdate:checked":a[5]||(a[5]=a=>e.rememberMe=a),size:"small"},{default:b((()=>[w(k(e.t("sys.login.rememberMe")),1)])),_:1},8,["checked"])])),_:1})])),_:1}),L(u,{span:12},{default:b((()=>[L(r,{style:{"text-align":"right"}},{default:b((()=>[L(m,{type:"link",size:"small",onClick:a[6]||(a[6]=a=>e.setLoginState(e.LoginStateEnum.RESET_PASSWORD))},{default:b((()=>[w(k(e.t("sys.login.forgetPassword")),1)])),_:1})])),_:1})])),_:1})])),_:1}),L(r,{class:"enter-x"},{default:b((()=>[L(m,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:b((()=>[w(k(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1}),L(g,{class:"enter-x"},{default:b((()=>[L(u,{xs:24,md:8},{default:b((()=>[L(m,{block:"",onClick:a[7]||(a[7]=a=>e.setLoginState(e.LoginStateEnum.MOBILE))},{default:b((()=>[w(k(e.t("sys.login.mobileSignInFormTitle")),1)])),_:1})])),_:1}),L(u,{md:8,xs:24,class:"!my-2 md:!my-0 xs:mx-0 md:mx-2"},{default:b((()=>[L(m,{block:"",onClick:a[8]||(a[8]=a=>e.setLoginState(e.LoginStateEnum.QR_CODE))},{default:b((()=>[w(k(e.t("sys.login.qrSignInFormTitle")),1)])),_:1})])),_:1}),L(u,{md:7,xs:24},{default:b((()=>[L(m,{block:"",onClick:a[9]||(a[9]=a=>e.setLoginState(e.LoginStateEnum.REGISTER))},{default:b((()=>[w(k(e.t("sys.login.registerButton")),1)])),_:1})])),_:1})])),_:1}),L(p,{class:"enter-x"},{default:b((()=>[w(k(e.t("sys.login.otherSignIn")),1)])),_:1}),L("div",{class:["flex justify-evenly enter-x",`${e.prefixCls}-sign-in-way`]},[L(f),L(h),L(y),L(x),L(P)],2)])),_:1},8,["model","rules","onKeypress"]),[[S,e.getShow]])],64)};export default A;
